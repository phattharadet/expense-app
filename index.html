<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>รายรับรายจ่าย</title>

<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<style>
body{font-family:system-ui;background:#f5f7fa;margin:0;}
.container{max-width:500px;margin:auto;padding:15px;}
.card{background:white;padding:18px;border-radius:16px;box-shadow:0 4px 12px rgba(0,0,0,0.05);margin-bottom:15px;}

.logo{text-align:center;margin-bottom:10px;}
.logo span{font-size:48px;color:#4CAF50;background:#E8F5E9;padding:12px;border-radius:50%;}

h2{text-align:center;margin:5px 0 15px;}

input,select{
width:100%;padding:12px;margin-bottom:10px;border-radius:10px;
border:1px solid #ddd;font-size:16px;
}

.btn-row{display:flex;gap:10px;}
button{flex:1;padding:12px;border:none;border-radius:12px;font-size:16px;color:white;}
.add{background:#4CAF50;}
.clear{background:#ff3b30;}

.item{
display:flex;justify-content:space-between;align-items:center;
margin-top:8px;background:#fafafa;padding:12px;border-radius:12px;
}

.left{font-size:14px;}
.date{font-size:12px;color:#888;}

.income{color:#2e7d32;font-weight:bold;}
.expense{color:#c62828;font-weight:bold;}

.actions span{
cursor:pointer;
margin-left:8px;
color:#888;
}

.summary{text-align:right;margin-top:10px;font-weight:bold;font-size:18px;}
.balance-plus{color:#2e7d32;}
.balance-minus{color:#c62828;}

.version{
text-align:center;
font-size:12px;
color:#999;
margin-top:10px;
}
</style>
</head>

<body>

<div class="container">

<div class="card">

<div class="logo">
<span class="material-icons">account_balance_wallet</span>
</div>

<h2>บันทึกรายรับรายจ่าย</h2>

<input type="date" id="date">
<input type="text" id="detail" placeholder="รายละเอียด">
<input type="number" id="amount" placeholder="จำนวนเงิน">

<select id="type">
<option value="income">รายรับ</option>
<option value="expense">รายจ่าย</option>
</select>

<div class="btn-row">
<button class="add" onclick="addItem()">บันทึก</button>
<button class="clear" onclick="clearAll()">เคลียร์</button>
</div>

</div>

<div class="card">
<div id="list"></div>
<div class="summary" id="summary"></div>
</div>

<div class="version">ver. 1.0.0</div>

</div>

<script>
let data = JSON.parse(localStorage.getItem("data")) || [];
let editIndex = null;

function save(){
localStorage.setItem("data",JSON.stringify(data));
}

function formatDate(dateStr){
const d = new Date(dateStr);
const thaiMonths = ["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."];
return d.getDate()+" "+thaiMonths[d.getMonth()]+" "+(d.getFullYear()+543);
}

function addItem(){
const date = document.getElementById("date").value;
const detail = document.getElementById("detail").value;
const amount = document.getElementById("amount").value;
const type = document.getElementById("type").value;

if(!date || !detail || !amount) return;

const item = {date,detail,amount,type};

if(editIndex !== null){
data[editIndex] = item;
editIndex = null;
}else{
data.push(item);
}

save();
clearForm();
show();
}

function editItem(index){
const d = data[index];

document.getElementById("date").value = d.date;
document.getElementById("detail").value = d.detail;
document.getElementById("amount").value = d.amount;
document.getElementById("type").value = d.type;

editIndex = index;
}

function deleteItem(index){
if(confirm("ลบรายการนี้?")){
data.splice(index,1);
save();
show();
}
}

function clearForm(){
document.getElementById("date").value="";
document.getElementById("detail").value="";
document.getElementById("amount").value="";
editIndex=null;
}

function show(){
const list = document.getElementById("list");
list.innerHTML="";

let income=0,expense=0;

data.sort((a,b)=> new Date(b.date) - new Date(a.date));

data.forEach((d,i)=>{

if(d.type=="income") income+=parseInt(d.amount);
else expense+=parseInt(d.amount);

list.innerHTML+=`
<div class="item">
<div class="left">
<div>${d.detail}</div>
<div class="date">${formatDate(d.date)}</div>
</div>

<div>
<div class="${d.type}">
${d.type=="income" ? "+" : "-"}${d.amount}
</div>

<div class="actions">
<span onclick="editItem(${i})" class="material-icons">edit</span>
<span onclick="deleteItem(${i})" class="material-icons">delete</span>
</div>
</div>

</div>`;
});

let balance = income-expense;

document.getElementById("summary").innerHTML=`
รายรับ: <span class="income">${income}</span> |
รายจ่าย: <span class="expense">${expense}</span><br>
คงเหลือ: <span class="${balance>=0 ? 'balance-plus':'balance-minus'}">${balance}</span> บาท
`;
}

function clearAll(){
if(confirm("ลบทั้งหมด?")){
data=[];
save();
show();
}
}

show();
</script>

</body>
</html>
