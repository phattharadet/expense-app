<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</title>

<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&display=swap" rel="stylesheet">

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{margin:0;font-family:'Prompt',sans-serif;background:#f1f5f9;}
.dark{background:#111;color:#fff;}

.header{background:#2563eb;color:#fff;padding:15px;text-align:center;font-size:20px;}

.page{display:none;padding:15px;}
.active{display:block;}

.card{background:#fff;padding:15px;border-radius:15px;margin-bottom:15px;}
.dark .card{background:#1e1e1e;}

.balance{text-align:center;font-size:26px;font-weight:600;}

.item{display:flex;justify-content:space-between;background:#fff;padding:12px;border-radius:12px;margin-bottom:10px;}
.dark .item{background:#1e1e1e;}

.income{color:#16a34a;font-weight:600;}
.expense{color:#dc2626;font-weight:600;}

.fab{
position:fixed;right:20px;bottom:80px;background:#2563eb;color:#fff;
width:55px;height:55px;border-radius:50%;font-size:30px;border:none;
}

.nav{position:fixed;bottom:0;width:100%;display:flex;background:#fff;border-top:1px solid #ddd;}
.nav button{flex:1;padding:12px;border:none;background:none;}

.modal{position:fixed;inset:0;background:rgba(0,0,0,0.3);display:none;justify-content:center;align-items:center;}
.modal-content{background:#fff;padding:20px;border-radius:15px;width:90%;}
.dark .modal-content{background:#1e1e1e;}

input,select{width:100%;padding:12px;margin-top:10px;border-radius:10px;border:1px solid #ddd;}

.version{text-align:center;font-size:12px;color:#888;margin-top:10px;}
</style>
</head>

<body id="body">

<div class="header">üí∞ ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</div>

<div id="home" class="page active">
  <div class="card balance">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: <span id="balance">0</span></div>

  <select id="monthSelect" onchange="render()"></select>

  <div id="list"></div>
</div>

<div id="summary" class="page">
  <div class="card">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏ß‡∏°: <span id="sumIncome">0</span></div>
  <div class="card">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏ß‡∏°: <span id="sumExpense">0</span></div>
  <canvas id="chart"></canvas>
</div>

<div id="setting" class="page">
  <div class="card">
    <button onclick="toggleDarkMode()">üåô ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÇ‡∏´‡∏°‡∏î</button>
    <button onclick="clearData()">üóë ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
  </div>
  <div class="version">ver. 1.1.0</div>
</div>

<button class="fab" onclick="openModal()">+</button>

<div class="modal" id="modal">
  <div class="modal-content">
    <h3>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</h3>
    <input id="detail" placeholder="‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£">
    <input id="amount" type="number" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô">

    <select id="type">
      <option value="income">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</option>
      <option value="expense">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</option>
    </select>

    <input id="date" type="date">
    <button onclick="addItem()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
  </div>
</div>

<div class="nav">
  <button onclick="showPage('home')">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
  <button onclick="showPage('summary')">‡∏™‡∏£‡∏∏‡∏õ</button>
  <button onclick="showPage('setting')">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
</div>

<script>
let data = JSON.parse(localStorage.getItem("data")) || [];
let chart;

function save(){localStorage.setItem("data",JSON.stringify(data));}

function showPage(page){
document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
document.getElementById(page).classList.add("active");
if(page==="summary") renderChart();
}

function openModal(){modal.style.display="flex";}

function addItem(){
data.push({
detail:detail.value,
amount:+amount.value,
type:type.value,
date:date.value
});
save();
render();
modal.style.display="none";
}

function render(){
let month=monthSelect.value;
list.innerHTML="";
let balance=0,income=0,expense=0;

data.filter(d=>d.date.startsWith(month)).forEach((d,i)=>{
balance+=d.type==="income"?d.amount:-d.amount;
if(d.type==="income") income+=d.amount; else expense+=d.amount;

list.innerHTML+=`
<div class="item">
<div>
${d.detail}<br>
<small>${new Date(d.date).toLocaleDateString('th-TH')}</small>
</div>
<div>
<span class="${d.type}">
${d.type==="income"?"+":"-"}${d.amount}
</span>
<button onclick="deleteItem(${i})">‚ùå</button>
</div>
</div>`;
});

balanceEl.innerText=balance;
sumIncome.innerText=income;
sumExpense.innerText=expense;
}

function deleteItem(i){
data.splice(i,1);
save();
render();
}

function clearData(){
localStorage.clear();
data=[];
render();
}

function toggleDarkMode(){
body.classList.toggle("dark");
}

function renderChart(){
let income=+sumIncome.innerText;
let expense=+sumExpense.innerText;

if(chart) chart.destroy();

chart=new Chart(document.getElementById("chart"),{
type:"doughnut",
data:{
labels:["‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö","‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢"],
datasets:[{data:[income,expense]}]
}
});
}

function loadMonths(){
let months=[...new Set(data.map(d=>d.date.substring(0,7)))];
monthSelect.innerHTML=months.map(m=>`<option value="${m}">${m}</option>`).join("");
}

loadMonths();
render();
</script>

</body>
</html>
